<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>FaKi pharmacy</title>
        <link rel="stylesheet" href="./styles/style.css">
    </head>

    <body>
        <div id="landing-page" class="page active landing-page">
            <div class="header">
                <div class="container">
                    <div class="header-content">
                        <div class="logo">
                            <div class="logo-icon">
                                <svg fill="none" stroke="white" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                                </svg>
                            </div>
                            <div class="logo-text">
                                <h1>PharmaCare</h1>
                                <p>Management System</p>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="showAuth()">Sign In</button>
                    </div>
                </div>
            </div>

            <div class="hero">
                <div class="container">
                    <h1>Complete Pharmacy<br>Management Solution</h1>
                    <p>Streamline your pharmacy operations with our comprehensive platform for medicine inventory, prescription management, and patient care coordination.</p>
                    <button class="btn btn-primary" onclick="showAuth()">Get Started</button>
                </div>
            </div>

            <div class="container">
                <div class="features-grid">
                    <div class="feature-card">
                        <h3>Medicine Inventory</h3>
                        <p>Complete CRUD operations for medicine management with stock tracking</p>
                    </div>
                    <div class="feature-card">
                        <h3>Digital Prescriptions</h3>
                        <p>Doctors can create and manage prescriptions digitally</p>
                    </div>
                    <div class="feature-card">
                        <h3>Patient Orders</h3>
                        <p>Easy prescription retrieval and ordering system</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="auth-page" class="page auth-page">
            <div class="auth-card">
                <div style="text-align: center; margin-bottom: 1.5rem;">
                    <div class="logo-icon" style="width: 3.5rem; height: 3.5rem; margin: 0 auto 1rem;">
                        <svg fill="none" stroke="white" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                        </svg>
                    </div>
                    <h1 style="font-size: 1.5rem; margin-bottom: 0.5rem;">Pharmacy Management</h1>
                    <p style="font-size: 0.875rem; color: #6b7280;">Sign in or create an account</p>
                </div>

                <div class="tab-list">
                    <button class="tab active" onclick="switchAuthTab('signin')">Sign In</button>
                    <button class="tab" onclick="switchAuthTab('signup')">Sign Up</button>
                </div>

                <div id="signin-content">
                    <form onsubmit="handleSignIn(event)">
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" id="signin-email" placeholder="your@email.com" required>
                        </div>
                        <div class="input-group">
                            <label>Password</label>
                            <input type="password" id="signin-password" placeholder="Enter password" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Sign In</button>
                    </form>

                    <div style="margin-top: 1.5rem; padding: 1rem; background: #f0fdf4; border-radius: 0.5rem; font-size: 0.75rem;">
                        <p><strong>Demo:</strong> admin@pharmacy.com / admin123</p>
                        <p><strong>Doctor:</strong> doctor@clinic.com / doctor123</p>
                        <p><strong>Patient:</strong> patient@email.com / patient123</p>
                    </div>
                </div>

                <div id="signup-content" class="hidden">
                    <form onsubmit="handleSignUp(event)">
                        <div class="input-group">
                            <label>Full Name</label>
                            <input type="text" id="signup-name" placeholder="John Doe" required>
                        </div>
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" id="signup-email" placeholder="your@email.com" required>
                        </div>
                        <div class="input-group">
                            <label>Password</label>
                            <input type="password" id="signup-password" placeholder="Create password" required>
                        </div>
                        <div class="input-group">
                            <label>Role</label>
                            <select id="signup-role" onchange="toggleNationalId()">
                                <option value="patient">Patient</option>
                                <option value="doctor">Doctor</option>
                                <option value="pharmacist">Pharmacist/Admin</option>
                            </select>
                        </div>
                        <div id="national-id-group" class="input-group">
                            <label>National ID (Optional)</label>
                            <input type="text" id="signup-national-id" placeholder="Enter National ID">
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Create Account</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Pharmacist Dashboard -->
        <div id="pharmacist-dashboard" class="page dashboard">
            <div class="dashboard-header">
                <div class="container flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <div class="logo-icon" style="width: 2rem; height: 2rem;">
                            <svg fill="none" stroke="white" viewBox="0 0 24 24" style="width: 1rem; height: 1rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                            </svg>
                        </div>
                        <div>
                            <h2 style="font-weight: 600;">Pharmacy Admin</h2>
                            <p style="font-size: 0.75rem; color: #6b7280;">Welcome, <span id="pharmacist-name"></span></p>
                        </div>
                    </div>
                    <button class="btn btn-outline" onclick="logout()">Logout</button>
                </div>
            </div>
            <div class="dashboard-content container">
                <div class="flex items-center justify-between mb-4">
                    <h1 style="font-size: 1.875rem; font-weight: 700;">Medicine Inventory</h1>
                    <button class="btn btn-primary" onclick="showAddMedicine()">Add Medicine</button>
                </div>

                <div class="card">
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Batch</th>
                                <th>Expiry</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="medicines-table"></tbody>
                    </table>
                </div>

                <div class="card">
                    <h2 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 1rem;">User Management</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>National ID</th>
                            </tr>
                        </thead>
                        <tbody id="users-table"></tbody>
                    </table>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                    <div class="card">
                        <h3 style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">Total Revenue</h3>
                        <p style="font-size: 2rem; font-weight: 700;" id="total-revenue">$0.00</p>
                        <p style="font-size: 0.75rem; color: #6b7280;">From <span id="total-orders">0</span> orders</p>
                    </div>
                    <div class="card">
                        <h3 style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">Total Medicines</h3>
                        <p style="font-size: 2rem; font-weight: 700;" id="total-medicines">0</p>
                        <p style="font-size: 0.75rem; color: #6b7280;">In inventory</p>
                    </div>
                    <div class="card">
                        <h3 style="font-size: 0.875rem; color: #6b7280; margin-bottom: 0.5rem;">Low Stock Items</h3>
                        <p style="font-size: 2rem; font-weight: 700;" id="low-stock-count">0</p>
                        <p style="font-size: 0.75rem; color: #6b7280;">Below 10 units</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Doctor Dashboard -->
        <div id="doctor-dashboard" class="page dashboard">
            <div class="dashboard-header">
                <div class="container flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <div class="logo-icon" style="width: 2rem; height: 2rem; background: #10b981;">
                            <svg fill="none" stroke="white" viewBox="0 0 24 24" style="width: 1rem; height: 1rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                        </div>
                        <div>
                            <h2 style="font-weight: 600;">Doctor Portal</h2>
                            <p style="font-size: 0.75rem; color: #6b7280;">Dr. <span id="doctor-name"></span></p>
                        </div>
                    </div>
                    <button class="btn btn-outline" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="dashboard-content container">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem;">
                    <div class="card">
                        <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem;">Create Prescription</h2>
                        <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 1.5rem;">Prescribe medicines to a patient</p>

                        <form onsubmit="createPrescription(event)">
                            <div class="input-group">
                                <label>Patient National ID</label>
                                <input type="text" id="patient-national-id" placeholder="Enter patient's National ID" required>
                            </div>

                            <div style="border-top: 1px solid #e5e7eb; padding-top: 1rem; margin-top: 1rem;">
                                <h3 style="font-weight: 600; margin-bottom: 1rem;">Add Medicines</h3>
                                
                                <div class="input-group">
                                    <label>Select Medicine</label>
                                    <select id="selected-medicine">
                                        <option value="">Choose a medicine</option>
                                    </select>
                                </div>

                                <div class="grid-2">
                                    <div class="input-group">
                                        <label>Dosage</label>
                                        <input type="text" id="dosage" placeholder="e.g., 500mg">
                                    </div>
                                    <div class="input-group">
                                        <label>Duration</label>
                                        <input type="text" id="duration" placeholder="e.g., 7 days">
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label>Quantity</label>
                                    <input type="number" id="quantity" value="1" min="1">
                                </div>

                                <button type="button" onclick="addMedicineToPrescription()" class="btn btn-outline" style="width: 100%;">Add to Prescription</button>
                            </div>

                            <div id="prescribed-medicines-list" class="hidden" style="border-top: 1px solid #e5e7eb; padding-top: 1rem; margin-top: 1rem;">
                                <h3 style="font-weight: 600; margin-bottom: 0.75rem;">Prescribed Medicines</h3>
                                <div id="prescribed-medicines"></div>
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 1rem; background: #10b981;">Create Prescription</button>
                        </form>

                        </div>
                            <div class="card">
                        <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem;">Medicine Database</h2>
                        <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 1.5rem;">Search and view available medicines</p>

                        <div class="flex gap-2 mb-4">
                            <input type="text" id="search-query" placeholder="Search medicines..." style="flex: 1;">
                            <button onclick="searchMedicines()" class="btn btn-primary">Search</button>
                        </div>

                        <div style="border: 1px solid #e5e7eb; border-radius: 0.5rem; max-height: 500px; overflow-y: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Medicine</th>
                                        <th>Category</th>
                                        <th>Stock</th>
                                    </tr>
                                </thead>
                                <tbody id="doctor-medicines-table"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>                

        <!-- Patient Dashboard -->
        <div id="patient-dashboard" class="page dashboard">
            <div class="dashboard-header">
                <div class="container flex items-center justify-between">
                    <div class="flex items-center gap-2">
                        <div class="logo-icon" style="width: 2rem; height: 2rem; background: #7c3aed;">
                            <svg fill="none" stroke="white" viewBox="0 0 24 24" style="width: 1rem; height: 1rem;">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </div>
                        <div>
                            <h2 style="font-weight: 600;">Patient Portal</h2>
                            <p style="font-size: 0.75rem; color: #6b7280;">Welcome, <span id="patient-name"></span></p>
                        </div>
                    </div>
                    <button class="btn btn-outline" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="dashboard-content container">
                <div class="card">
                    <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem;">Retrieve Prescription</h2>
                    <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 1.5rem;">Enter your prescription ID to view and order medicines</p>

                    <form onsubmit="searchPrescription(event)">
                        <div class="flex gap-2">
                            <input type="text" id="prescription-number" placeholder="e.g., RX-20251115-001" required style="flex: 1;">
                            <button type="submit" class="btn btn-primary">Search</button>
                        </div>
                    </form>
                </div>

                <div id="prescription-details" class="hidden">
                    <div class="card">
                        <h2 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;">Prescription Details</h2>
                        <p style="font-size: 0.875rem; color: #6b7280; margin-bottom: 1rem;">
                            Prescription by <strong id="doctor-name-display"></strong> on <span id="prescription-date"></span>
                        </p>
                        <p style="padding: 0.75rem; background: #dbeafe; color: #1e40af; border-radius: 0.5rem; margin-bottom: 1rem;">
                            Prescription Number: <strong id="prescription-num-display"></strong>
                        </p>

                        <table style="border: 1px solid #e5e7eb; border-radius: 0.5rem; overflow: hidden; margin-bottom: 1rem;">
                            <thead>
                                <tr>
                                    <th>Select</th> <th>Medicine</th>
                                    <th>Dosage</th>
                                    <th>Duration</th>
                                    <th>Quantity</th>
                                    <th>Price</th>
                                    <th>Total</th>
                                </tr>
                            </thead>
                            <tbody id="prescription-medicines"></tbody>
                        </table>

                        <button onclick="placeOrder()" class="btn btn-primary" style="width: 100%; background: #7c3aed;">Confirm and Place Order</button>
                    </div>
                </div>

                <div class="card">
                    <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem;">Your Prescriptions</h2>
                    <div id="prescription-history-list"></div>
                </div>

                <div class="card">
                    <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem;">Order History</h2>
                    <div id="order-history-list"></div>
                </div>
            </div>
        </div>

        <!-- Medicine Modal -->
        <div id="medicine-modal" class="modal">
            <div class="modal-content">
                <div class="flex items-center justify-between mb-4">
                    <h2 style="font-size: 1.25rem; font-weight: 700;" id="modal-title">Add Medicine</h2>
                    <button onclick="closeMedicineModal()" style="border: none; background: none; cursor: pointer; font-size: 1.5rem;">&times;</button>
                </div>

                <form onsubmit="saveMedicine(event)">
                    <input type="hidden" id="medicine-id">
                    <div class="grid-2">
                        <div class="input-group">
                            <label>Medicine Name</label>
                            <input type="text" id="medicine-name" required>
                        </div>
                        <div class="input-group">
                            <label>Category</label>
                            <input type="text" id="medicine-category" required>
                        </div>
                        <div class="input-group">
                            <label>Manufacturer</label>
                            <input type="text" id="medicine-manufacturer" required>
                        </div>
                        <div class="input-group">
                            <label>Batch Number</label>
                            <input type="text" id="medicine-batch" required>
                        </div>
                        <div class="input-group">
                            <label>Expiry Date</label>
                            <input type="date" id="medicine-expiry" required>
                        </div>
                        <div class="input-group">
                            <label>Price ($)</label>
                            <input type="number" step="0.01" id="medicine-price" required>
                        </div>
                        <div class="input-group">
                            <label>Quantity</label>
                            <input type="number" id="medicine-quantity" required>
                        </div>
                    </div>
                    <div class="flex gap-2" style="margin-top: 1rem;">
                        <button type="submit" class="btn btn-primary">Save Medicine</button>
                        <button type="button" onclick="closeMedicineModal()" class="btn btn-outline">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </body>
</html>